<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digha Weather Forecast (Open-Meteo)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(to bottom, #e3f2fd, #bbdefb);
            margin: 0;
            padding: 20px 0;
            box-sizing: border-box;
            color: #333;
        }

        .ad-slot {
            margin: 25px auto;
            border: 1px dashed #90caf9;
            padding: 15px;
            text-align: center;
            background-color: rgba(255, 255, 255, 0.7);
            width: 90%;
            max-width: 728px;
            box-sizing: border-box;
            font-size: 0.95em;
            color: #424242;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .weather-container {
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 40px;
            text-align: center;
            max-width: 500px;
            width: 100%;
            border: 1px solid #90caf9;
            margin-bottom: 30px;
        }

        .logo-container {
            margin-bottom: 25px;
        }

        .logo {
            max-width: 180px;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        h1 {
            color: #0d47a1;
            margin-bottom: 20px;
            font-size: 2.5em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }

        #location {
            font-size: 1.9em;
            color: #1976d2;
            margin-bottom: 25px;
            font-weight: bold;
        }

        #current-temp {
            font-size: 5em;
            font-weight: bold;
            color: #2196f3;
            margin-bottom: 15px;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
        }

        #current-description {
            font-size: 1.6em;
            color: #424242;
            margin-bottom: 25px;
            text-transform: capitalize;
        }

        .current-details {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
            padding: 15px 0;
            border-top: 1px dashed #e0e0e0;
            border-bottom: 1px dashed #e0e0e0;
        }

        .detail-item {
            text-align: center;
            min-width: 100px;
            flex: 1;
        }

        .detail-label {
            font-size: 1em;
            color: #757575;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #1565c0;
        }

        /* 7-Day Forecast Styling */
        .forecast-section {
            width: 90%;
            max-width: 800px;
            margin: 40px auto;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            border: 1px solid #90caf9;
        }

        .forecast-section h2 {
            color: #0d47a1;
            font-size: 2em;
            margin-bottom: 25px;
            text-align: center;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            justify-content: center;
        }

        .forecast-card {
            background-color: #e3f2fd;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid #bbdefb;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .forecast-card h3 {
            color: #1976d2;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .forecast-card p {
            margin: 5px 0;
            font-size: 0.95em;
            color: #424242;
        }

        .forecast-card .temp-range {
            font-size: 1.1em;
            font-weight: bold;
            color: #2196f3;
            margin: 8px 0;
        }

        .forecast-card .detail-value {
            font-size: 1em;
            color: #1565c0;
        }

        .forecast-card .rain-chance {
            color: #388e3c;
            font-weight: bold;
        }

        .forecast-card .thunderstorm {
            color: #d32f2f;
            font-weight: bold;
        }

        #error-message {
            color: #d32f2f;
            margin-top: 20px;
            font-weight: bold;
        }

        footer {
            background-color: #0d47a1;
            color: #e3f2fd;
            text-align: center;
            padding: 25px;
            width: 100%;
            box-sizing: border-box;
            border-top: 3px solid #1565c0;
            margin-top: auto;
            font-size: 0.95em;
        }

        .footer-info {
            line-height: 1.6;
        }

        /* Highlighted Current Day Styles */
        .current-day-highlight {
            font-size: 1.1em;
            font-weight: bold;
        }

        .current-day-highlight.rain {
            color: #388e3c; /* Green for rain */
        }

        .current-day-highlight.wind {
            color: #1565c0; /* Blue for wind */
        }

        .current-day-highlight.thunderstorm {
            color: #d32f2f; /* Red for thunderstorm */
        }

        .current-day-highlight.humidity {
            color: #2196f3; /* Bright blue for humidity */
        }

    </style>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX'); // Replace with your actual Google Analytics Measurement ID
    </script>
</head>
<body>

    <div class="ad-slot">
        <p>Advertisement Space 1</p>
    </div>

    <div class="weather-container">
        <div class="logo-container">
            <img src="mydigha.png" alt="MyDigha Logo" class="logo">
        </div>
        <h1>Current Weather in</h1>
        <div id="location">Digha, Purba Medinipur District, West Bengal â€“ 721428, India</div>
        <div id="current-temp">Loading...</div>
        <div id="current-description"></div>
        <div class="current-details">
            <div class="detail-item">
                <div class="detail-label">Humidity</div>
                <div class="detail-value"><span id="current-humidity"></span></div>
            </div>
             <div class="detail-item">
                <div class="detail-label">Wind Speed</div>
                <div class="detail-value"><span id="current-wind-speed"></span></div>
            </div>
            <div class="detail-item">
                <div class="detail-label">Wind Direction</div>
                <div class="detail-value"><span id="current-wind-direction"></span></div>
            </div>
            <div class="detail-item">
                <div class="detail-label">Sea Level Pressure</div>
                <div class="detail-value"><span id="current-sea-level-pressure"></span></div>
            </div>
             <div class="detail-item">
                <div class="detail-label">Rain</div>
                <div class="detail-value"><span id="current-rain"></span></div>
            </div>
            <div class="detail-item">
                <div class="detail-label">Thunderstorm</div>
                 <div class="detail-value"><span id="current-thunderstorm"></span></div>
            </div>
        </div>
        <div id="error-message" class="error"></div>
    </div>

    <div class="ad-slot">
        <p>Advertisement Space 2</p>
    </div>

    <div class="forecast-section">
        <h2>7-Day Forecast</h2>
        <div id="forecast-grid" class="forecast-grid">
            <p>Loading forecast...</p>
        </div>
    </div>

    <div class="ad-slot">
        <p>Advertisement Space 3</p>
    </div>

    <footer>
        <div class="footer-info">
            Contact: <a href="mailto:mydigha1@gmail.com" style="color: #90caf9; text-decoration: none;">mydigha1@gmail.com</a><br>
            This website is managed by Nexuzy Tech Pvt Ltd.
        </div>
    </footer>

    <script>
        // Precise coordinates for Digha, West Bengal
        const latitude = 21.638333;
        const longitude = 87.509722;
        const timezone = 'Asia/Kolkata';

        // Open-Meteo API endpoint for current and 7-day forecast
        const apiUrl = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&hourly=temperature_2m,relativehumidity_2m,weathercode,windspeed_10m,winddirection_10m,pressure_msl,precipitation_probability,windgusts_10m&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,windspeed_10m_max,winddirection_10m_dominant,pressure_msl_mean,weathercode&forecast_days=7&temperature_unit=celsius&windspeed_unit=ms&precipitation_unit=mm&timezone=${timezone}`;

        // Basic weather code to description mapping
        const weatherCodeDescriptions = {
            0: 'Clear sky',
            1: 'Mainly clear',
            2: 'Partly cloudy',
            3: 'Overcast',
            45: 'Fog',
            48: 'Depositing rime fog',
            51: 'Light Drizzle',
            53: 'Moderate Drizzle',
            55: 'Dense Drizzle',
            56: 'Light Freezing Drizzle',
            57: 'Dense Freezing Drizzle',
            61: 'Slight Rain',
            63: 'Moderate Rain',
            65: 'Heavy Rain',
            66: 'Light Freezing Rain',
            67: 'Heavy Freezing Rain',
            71: 'Slight Snow fall',
            73: 'Moderate Snow fall',
            75: 'Heavy Snow fall',
            77: 'Snow grains',
            80: 'Slight Rain showers',
            81: 'Moderate Rain showers',
            82: 'Violent Rain showers',
            85: 'Slight Snow showers',
            86: 'Heavy Snow showers',
            95: 'Thunderstorm',
            96: 'Thunderstorm with slight hail',
            99: 'Thunderstorm with heavy hail',
        };

        // Function to convert degrees to cardinal direction
        function getWindDirection(deg) {
            if (deg === undefined || deg === null) return 'N/A';
            if (deg >= 337.5 || deg < 22.5) return 'N';
            if (deg >= 22.5 && deg < 67.5) return 'NE';
            if (deg >= 67.5 && deg < 112.5) return 'E';
            if (deg >= 112.5 && deg < 157.5) return 'SE';
            if (deg >= 157.5 && deg < 202.5) return 'S';
            if (deg >= 202.5 && deg < 247.5) return 'SW';
            if (deg >= 247.5 && deg < 292.5) return 'W';
            if (deg >= 292.5 && deg < 337.5) return 'NW';
            return 'N/A';
        }

        async function getWeatherData() {
            try {
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();

                if (data.current_weather && data.hourly && data.daily) {
                    const currentWeather = data.current_weather;
                    const hourlyData = data.hourly;
                    const dailyData = data.daily;

                    // --- Update Current Weather ---
                    document.getElementById('current-temp').textContent = `${Math.round(currentWeather.temperature)}Â°C`;
                    document.getElementById('current-wind-speed').textContent = `${currentWeather.windspeed} m/s`;

                     const now = new Date();
                    // Find the index for the current hour in hourly data
                    const currentHourIndex = hourlyData.time.findIndex(timeStr => {
                        const date = new Date(timeStr);
                        return date.getFullYear() === now.getFullYear() &&
                               date.getMonth() === now.getMonth() &&
                               date.getDate() === now.getDate() &&
                               date.getHours() === now.getHours();
                    });

                    if (currentHourIndex !== -1) {
                        const currentHumidityValue = hourlyData.relativehumidity_2m[currentHourIndex];
                        const currentWindDirectionDeg = hourlyData.winddirection_10m[currentHourIndex];
                        const currentSeaLevelPressure = hourlyData.pressure_msl[currentHourIndex];
                         const currentWeatherCode = hourlyData.weathercode[currentHourIndex];
                        const currentRainChance = hourlyData.precipitation_probability[currentHourIndex];
                         const currentWindGust = hourlyData.windgusts_10m[currentHourIndex];

                        document.getElementById('current-humidity').textContent = currentHumidityValue !== undefined ? `<span class="current-day-highlight humidity">${currentHumidityValue}%</span>` : 'N/A';
                         document.getElementById('current-wind-speed').textContent = currentWindGust !== undefined ? `<span class="current-day-highlight wind">${currentWindGust} m/s</span>` : 'N/A';
                        document.getElementById('current-wind-direction').textContent = getWindDirection(currentWindDirectionDeg);
                        document.getElementById('current-sea-level-pressure').textContent = currentSeaLevelPressure !== undefined ? `${Math.round(currentSeaLevelPressure)} hPa` : 'N/A';
                         document.getElementById('current-rain').textContent = currentRainChance !== undefined ? `<span class="current-day-highlight rain">${currentRainChance}%</span>` : 'N/A';
                        document.getElementById('current-thunderstorm').textContent = weatherCodeDescriptions.hasOwnProperty(currentWeatherCode) && (currentWeatherCode >= 95 && currentWeatherCode <= 99) ? `<span class="current-day-highlight thunderstorm">Yes</span>` : 'No';
                        document.getElementById('current-description').textContent = weatherCodeDescriptions.hasOwnProperty(currentWeatherCode) ? weatherCodeDescriptions[currentWeatherCode] : 'Conditions available';

                    } else {
                        document.getElementById('current-humidity').textContent = 'N/A';
                        document.getElementById('current-wind-speed').textContent = 'N/A';
                         document.getElementById('current-wind-direction').textContent = 'N/A';
                        document.getElementById('current-sea-level-pressure').textContent = 'N/A';
                        document.getElementById('current-rain').textContent = 'N/A';
                        document.getElementById('current-thunderstorm').textContent = 'No';
                        document.getElementById('current-description').textContent = 'Detailed info not available';
                    }

                    // --- Update 7-Day Forecast ---
                    const forecastGrid = document.getElementById('forecast-grid');
                    forecastGrid.innerHTML = '';

                    for (let i = 0; i < dailyData.time.length; i++) {
                        const date = new Date(dailyData.time[i]);
                        const options = { weekday: 'short', month: 'short', day: 'numeric' };
                        const dayString = date.toLocaleDateString('en-US', options);

                        const maxTemp = Math.round(dailyData.temperature_2m_max[i]);
                        const minTemp = Math.round(dailyData.temperature_2m_min[i]);
                        const precipitation = dailyData.precipitation_sum[i];
                        const precipitationProbability = dailyData.precipitation_probability_max[i];
                        const maxWindSpeed = dailyData.windspeed_10m_max[i];
                        const dominantWindDirectionDeg = dailyData.winddirection_10m_dominant[i];
                        const meanSeaLevelPressure = dailyData.pressure_msl_mean[i];
                        const weatherCode = dailyData.weathercode[i];

                        const description = weatherCodeDescriptions.hasOwnProperty(weatherCode) ? weatherCodeDescriptions[weatherCode] : 'N/A';
                        const isThunderstorm = weatherCode >= 95 && weatherCode <= 99;

                        const card = document.createElement('div');
                        card.classList.add('forecast-card');
                        card.innerHTML = `
                            <h3>${dayString}</h3>
                            <p class="temp-range">${minTemp}Â°C / ${maxTemp}Â°C</p>
                            <p>${description}</p>
                            ${isThunderstorm ? '<p class="thunderstorm">âš¡ Thunderstorm Likely</p>' : ''}
                            <p>Rain: <span class="detail-value">${precipitation !== undefined ? precipitation.toFixed(1) : 'N/A'} mm</span></p>
                            <p>Rain Chance: <span class="detail-value rain-chance">${precipitationProbability !== undefined ? precipitationProbability : 'N/A'}%</span></p>
                            <p>Wind: <span class="detail-value">${maxWindSpeed !== undefined ? maxWindSpeed.toFixed(1) : 'N/A'} m/s ${getWindDirection(dominantWindDirectionDeg)}</span></p>
                            <p>Pressure: <span class="detail-value">${meanSeaLevelPressure !== undefined ? Math.round(meanSeaLevelPressure) : 'N/A'} hPa</span></p>
                        `;
                        forecastGrid.appendChild(card);
                    }

                document.getElementById('error-message').textContent = '';

                } else if (data.error) {
                    document.getElementById('error-message').textContent = `API Error: ${data.reason}`;
                    document.getElementById('current-temp').textContent = '--';
                    document.getElementById('current-description').textContent = '';
                    document.getElementById('current-humidity').textContent = '';
                    document.getElementById('current-wind-speed').textContent = '';
                     document.getElementById('current-wind-direction').textContent = '';
                    document.getElementById('current-sea-level-pressure').textContent = '';
                    document.getElementById('current-rain').textContent = '';
                    document.getElementById('current-thunderstorm').textContent = 'No';
                    document.getElementById('forecast-grid').innerHTML = '<p>Error loading forecast.</p>';
                } else {
                     document.getElementById('error-message').textContent = 'Could not retrieve weather data.  Please check the API or your internet connection.';
                    document.getElementById('current-temp').textContent = '--';
                    document.getElementById('current-description').textContent = '';
                    document.getElementById('current-humidity').textContent = '';
                    document.getElementById('current-wind-speed').textContent = '';
                     document.getElementById('current-wind-direction').textContent = '';
                    document.getElementById('current-sea-level-pressure').textContent = '';
                     document.getElementById('current-rain').textContent = '';
                    document.getElementById('current-thunderstorm').textContent = 'No';
                    document.getElementById('forecast-grid').innerHTML = '<p>Error loading forecast.</p>';
                }
            } catch (error) {
                console.error('Error fetching weather data:', error);
                document.getElementById('error-message').textContent = 'Network error or unable to fetch data.  Check console for details.';
                document.getElementById('current-temp').textContent = '--';
                document.getElementById('current-description').textContent = '';
                document.getElementById('current-humidity').textContent = '';
                 document.getElementById('current-wind-speed').textContent = '';
                  document.getElementById('current-wind-direction').textContent = '';
                document.getElementById('current-sea-level-pressure').textContent = '';
                 document.getElementById('current-rain').textContent = '';
                document.getElementById('current-thunderstorm').textContent = 'No';
                document.getElementById('forecast-grid').innerHTML = '<p>Error loading forecast.</p>';
            }
        }

        document.addEventListener('DOMContentLoaded', getWeatherData);
        setInterval(getWeatherData, 300000); // Refresh every 5 minutes
    </script>
</body>
</html>
